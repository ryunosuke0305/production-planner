# システム管理者向け

## 運用・保守のポイント

### データ保存とバックアップ
- 計画データは `data/plan.sqlite` に保存されます。
- 品目コード（品目ID）などのマスタ情報も SQLite に保存されます。
- 定期的に `data/` ディレクトリ全体をバックアップしてください。
- 既存の `plan.json` を移行する場合は `npm run migrate:plan` を利用します。

### 環境変数とAPIキー
- `.env` は `data/` 配下に配置します（例: `data/.env`）。
- `GEMINI_API_KEY` を設定するとチャット更新機能を有効化できます。
- モデル切り替えは `GEMINI_MODEL` または `VITE_GEMINI_MODEL` を使用します。

### 権限・アクセスの運用
- マスタ管理は管理者が担当し、一般利用者は閲覧中心の運用にしてください。
- マスタ管理のトップ画面から「品目一覧」「原料一覧」を開き、登録内容を更新します。
- 品目一覧では賞味期限・製造効率・備考などの追加項目も合わせて更新します。
- 共有端末ではブラウザの自動入力やパスワード保存を無効にすることを推奨します。

### Excel取り込みの整備
- 取込フォーマットが変わる場合は、ヘッダー名の事前調整やテンプレート配布を行ってください。
- 読み込み対象外となる品目コードは、事前に品目マスタへ追加しておく必要があります。

### 長期運用の運用設計
- 週移動に合わせて計画カレンダーが前後へ拡張されるため、将来計画の入力が可能です。
- 長期運用で `data/plan.sqlite` のサイズが増えるため、定期バックアップと保管ポリシーの整備を推奨します。

### 画面テンプレートの変更
- メニュー構成や表示項目を変更した場合は、READMEとマニュアルの記載を必ず更新してください。
- 更新内容は、一般利用者向けと管理者向けの両方に反映することを推奨します。

## トラブル対応

### 計画データが表示されない場合
- `data/plan.sqlite` の存在を確認し、ファイル権限が読み書き可能か確認します。
- 開発サーバーのログで `/api/plan` のエラーが出ていないか確認します。

### チャット機能が動作しない場合
- `data/.env` に `GEMINI_API_KEY` が設定されているか確認します。
- ネットワーク設定やAPI利用制限も合わせて確認してください。
